<%= tag.table(**table.table_attributes) do %>
  <% if table.caption.present? %>
    <caption><%= table.caption %></caption>
  <% end %>
  <thead>
    <tr>
      <% table.columns.each do |column| %>
        <%= tag.th(**column.header_attributes) do %>
          <%= column.name %>
        <% end %>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% table.items.each_with_index do |item, i| %>
      <%=          # noinspection RubyArgCount
          tag.tr(**table.all_row_attributes(item, i)) do %>
        <% table.columns.each_with_index do |column, j| %>
          <%= tag.td(**column.body_attributes) do %>
            <%= column.value(item, i, j) %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  </tbody>
<% end %>
